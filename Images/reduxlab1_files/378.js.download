(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[378],{5895:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return _});var a=n(0),i=n(117),r=n(124),o=n(127),s=n(1033),c=n(73),d=n(1045),l=function(){function e(e,t){this._graphDataSource=t.graphDataSource,this._makeXHR=t.makeXHR||s.e.start,this._offlineDetection=t.offlineDetection}return e.prototype.getContents=function(e,t){var n=this;return this._makeXHR({url:t}).then(function(t){var n=t.status;if(!(n>=200&&n<300))return i.n.reject(t);try{var a=JSON.parse(t.responseText).metadata,r=a.delimiter,o=a.error,s=a.list,d=void 0===s?[]:s;return{delimiter:r,error:o,root:{children:d,date:e.dateModified,extension:e.extension,isFolder:!0,name:e.name,childCount:d.length,parentFolder:void 0,path:"",size:0}}}catch(e){return i.n.reject(new c.e({code:"".concat(n,".InvalidResponse"),message:e&&e.message,correlationId:u(t),isExpected:!0,extraData:{responseText:t.responseText}}))}}).catch(function(e){if(e instanceof c.e)return i.n.reject(e);var t,a=!1,r=e&&e.message,o="GetZipContents";if(e instanceof XMLHttpRequest){var s=e&&e.status;a=!!s&&s>=400&&s<500,s&&!n._offlineDetection.offline||(a=!0),t=u(e),o=e.getResponseHeader("X-ErrorCode")||"";try{for(var d=JSON.parse(e.responseText),l=d&&d.error;l.innererror;)l=l.innererror;l&&(r=l.message,o=l.code)}catch(t){r=e.responseText?"Invalid JSON response":"Empty response",a=!0}o="".concat(s,".").concat(o)}return i.n.reject(new c.e({code:o,message:r,isExpected:a,correlationId:t,extraData:{responseText:e instanceof XMLHttpRequest?e.responseText:""}}))})},e}();function u(e){return e.getResponseHeader("X-CorrelationId")||void 0}Object(r.r)("ZipDataSource",l,{graphDataSource:o.y,makeXHR:void 0,offlineDetection:d.e});var f=n(43),p=n(179),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._isOneDriveWinApp=Object(p.e)(),a}return Object(a.__extends)(t,e),t.prototype.getContents=function(t,n){var a=this;return n?i.n.resolve().then(function(){if(t.queryType===f.e.SharedWithMe&&a._isOneDriveWinApp&&a._graphDataSource.refreshAccessToken)return a._graphDataSource.refreshAccessToken(t)}).then(function(i){var r=i&&i.accessToken;return n.indexOf("access_token")<0&&r&&(n=n+"&access_token="+r),e.prototype.getContents.call(a,t,n)}):i.n.reject(new Error("No data."))},t}(l),_=(t.default=m,Object(r.r)("ZipDataSource",m,{graphDataSource:o.y,makeXHR:void 0,offlineDetection:d.e}))}}]);